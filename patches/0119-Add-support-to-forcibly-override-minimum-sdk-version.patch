From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: fgei <fgei@gmail.com>
Date: Tue, 23 Jan 2024 15:02:37 +0000
Subject: [PATCH] Add support to forcibly override minimum sdk version

---
 build/config/android/config.gni | 3 +++
 build/config/android/rules.gni  | 4 ++++
 2 files changed, 7 insertions(+)

diff --git a/build/config/android/config.gni b/build/config/android/config.gni
index 37398140f71f7..0e850edfb3f63 100644
--- a/build/config/android/config.gni
+++ b/build/config/android/config.gni
@@ -69,6 +69,9 @@ if (is_android || is_chromeos) {
     # not explicitly set it.
     default_min_sdk_version = 26
 
+    # This overrides the use for android:minSdkVersion for any targets.
+    override_min_sdk_version = 0
+
     # Static analysis can be either "on" or "off" or "build_server". This
     # controls how android lint, error-prone, bytecode checks are run. This
     # needs to be in a separate declare_args as it determines some of the args
diff --git a/build/config/android/rules.gni b/build/config/android/rules.gni
index 113b60905e683..00bcfe13370e8 100644
--- a/build/config/android/rules.gni
+++ b/build/config/android/rules.gni
@@ -2119,6 +2119,10 @@ if (enable_java_templates && is_android) {
       _target_sdk_version = invoker.target_sdk_version
     }
 
+    if (override_min_sdk_version > 0) {
+      _min_sdk_version = override_min_sdk_version
+    }
+
     _is_bundle_module =
         defined(invoker.is_bundle_module) && invoker.is_bundle_module
     if (_is_bundle_module) {
